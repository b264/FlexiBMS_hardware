EESchema Schematic File Version 2
LIBS:power
LIBS:device
LIBS:switches
LIBS:relays
LIBS:motors
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:Custom_comp_lib
LIBS:FlexiBMS-cache
EELAYER 25 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 1 19
Title "FlexiBMS"
Date "2018-02-22"
Rev "0.2"
Comp "SiMoS MCmuffin / Simo Sihvonen"
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Sheet
S 4300 4750 1850 1300
U 5A829533
F0 "Microcontroller" 60
F1 "Microcontroller.sch" 60
F2 "I2C1_SDA" I L 4300 4950 60 
F3 "I2C1_SCL" I L 4300 5050 60 
F4 "SPI1_CS" I L 4300 5150 60 
F5 "SPI1_CLK" I L 4300 5250 60 
F6 "SPI1_MOSI" I L 4300 5350 60 
F7 "SPI1_MISO" I L 4300 5450 60 
F8 "BULK_SENSE" I R 6150 5150 60 
F9 "CHARGER_SENSE" I R 6150 5250 60 
F10 "SWITCH_ID" I R 6150 5450 60 
F11 "LOAD_SENSE" I R 6150 5550 60 
F12 "SWITCH_TEMP" I R 6150 5650 60 
F13 "PRECHARGE_FET" I R 6150 5750 60 
F14 "DISCHARGE_FET" I R 6150 5850 60 
F15 "CHARGE_FET" I R 6150 4950 60 
F16 "5V_ENABLE" I L 4300 5750 60 
F17 "BOOST_ENABLE" I L 4300 4850 60 
$EndSheet
$Sheet
S 1600 5000 900  800 
U 5A82A74A
F0 "LTC6803-3" 60
F1 "BMS_stack_monitor.sch" 60
F2 "SPI_CS" I R 2500 5150 60 
F3 "SPI_MISO" I R 2500 5450 60 
F4 "SPI_MOSI" I R 2500 5350 60 
F5 "SPI_CLK" I R 2500 5250 60 
F6 "BAT+" I L 1600 5150 60 
F7 "WATCHDOG" I R 2500 5550 60 
F8 "VREG_5V" O R 2500 5650 60 
$EndSheet
$Sheet
S 1650 3400 800  500 
U 5A8293EE
F0 "MAX17502" 60
F1 "5V_Switch_regulator.sch" 60
F2 "VCC" I R 2450 3550 60 
F3 "ENABLE" I R 2450 3650 60 
F4 "5V_VREG" I R 2450 3750 60 
$EndSheet
$Sheet
S 1600 2550 900  500 
U 5A8310C4
F0 "currentMeasuring" 60
F1 "currentMeasuring.sch" 60
F2 "I2C_SDA" I R 2500 2950 60 
F3 "I2C_SCL" I R 2500 2850 60 
F4 "BAT+" I L 1600 2650 60 
F5 "VCC" I R 2500 2650 60 
$EndSheet
$Sheet
S 7800 2500 1600 700 
U 5A830810
F0 "Boost-DAC" 60
F1 "Boost-DAC.sch" 60
F2 "I2C_SCL" I L 7800 2850 60 
F3 "I2C_SDA" I L 7800 2950 60 
F4 "OUTPUT" I L 7800 2650 60 
F5 "INPUT" I R 9400 2650 60 
F6 "ENABLE" I L 7800 3050 60 
$EndSheet
Text Label 1000 2650 2    60   ~ 0
BAT+
Text Label 4200 4950 2    60   ~ 0
I2C_SDA
Text Label 4200 5050 2    60   ~ 0
I2C_SCL
Text Label 2600 2950 0    60   ~ 0
I2C_SDA
Text Label 2600 2850 0    60   ~ 0
I2C_SCL
Text Label 7700 2850 2    60   ~ 0
I2C_SCL
Text Label 7700 2950 2    60   ~ 0
I2C_SDA
$Comp
L Conn_02x08_Odd_Even J1
U 1 1 5A82F297
P 9350 4800
F 0 "J1" H 9400 5200 50  0000 C CNN
F 1 "Conn_02x08_Odd_Even" H 9400 4300 50  0000 C CNN
F 2 "Pin_Headers:Pin_Header_Straight_2x08_Pitch2.54mm" H 9350 4800 50  0001 C CNN
F 3 "" H 9350 4800 50  0001 C CNN
F 4 "\"PREC008DAAN-RC\"/\"PPTC082LFBN-RC\"/\"SFH210-PPPC-D08-ID-BK\"" H 9350 4800 60  0001 C CNN "MFG"
	1    9350 4800
	1    0    0    -1  
$EndComp
Text Notes 8800 4200 0    60   ~ 0
SWITCH-module connector
$Comp
L R R6
U 1 1 5A82FF85
P 9650 2850
F 0 "R6" V 9730 2850 50  0000 C CNN
F 1 "1M" V 9650 2850 50  0000 C CNN
F 2 "Resistors_SMD:R_0603" V 9580 2850 50  0001 C CNN
F 3 "" H 9650 2850 50  0001 C CNN
F 4 "ANY" V 9650 2850 60  0001 C CNN "MFG"
F 5 "1%" V 9650 2850 60  0001 C CNN "Tol."
	1    9650 2850
	1    0    0    -1  
$EndComp
$Comp
L R R7
U 1 1 5A82FF8D
P 9650 3250
F 0 "R7" V 9730 3250 50  0000 C CNN
F 1 "51k" V 9650 3250 50  0000 C CNN
F 2 "Resistors_SMD:R_0603" V 9580 3250 50  0001 C CNN
F 3 "" H 9650 3250 50  0001 C CNN
F 4 "ANY" V 9650 3250 60  0001 C CNN "MFG"
F 5 "1%" V 9650 3250 60  0001 C CNN "Tol."
	1    9650 3250
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR01
U 1 1 5A8312CD
P 9650 3450
F 0 "#PWR01" H 9650 3200 50  0001 C CNN
F 1 "GND" H 9650 3300 50  0000 C CNN
F 2 "" H 9650 3450 50  0001 C CNN
F 3 "" H 9650 3450 50  0001 C CNN
	1    9650 3450
	1    0    0    -1  
$EndComp
Text Label 9800 3050 0    60   ~ 0
MCU_CHARGER_SENSE
$Comp
L R R4
U 1 1 5A839810
P 6400 2850
F 0 "R4" V 6480 2850 50  0000 C CNN
F 1 "1M" V 6400 2850 50  0000 C CNN
F 2 "Resistors_SMD:R_0603" V 6330 2850 50  0001 C CNN
F 3 "" H 6400 2850 50  0001 C CNN
F 4 "ANY" V 6400 2850 60  0001 C CNN "MFG"
F 5 "1%" V 6400 2850 60  0001 C CNN "Tol."
	1    6400 2850
	1    0    0    -1  
$EndComp
$Comp
L R R5
U 1 1 5A839817
P 6400 3250
F 0 "R5" V 6480 3250 50  0000 C CNN
F 1 "51k" V 6400 3250 50  0000 C CNN
F 2 "Resistors_SMD:R_0603" V 6330 3250 50  0001 C CNN
F 3 "" H 6400 3250 50  0001 C CNN
F 4 "ANY" V 6400 3250 60  0001 C CNN "MFG"
F 5 "1%" V 6400 3250 60  0001 C CNN "Tol."
	1    6400 3250
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR02
U 1 1 5A839821
P 6400 3450
F 0 "#PWR02" H 6400 3200 50  0001 C CNN
F 1 "GND" H 6400 3300 50  0000 C CNN
F 2 "" H 6400 3450 50  0001 C CNN
F 3 "" H 6400 3450 50  0001 C CNN
	1    6400 3450
	1    0    0    -1  
$EndComp
Text Label 6550 3050 0    60   ~ 0
MCU_BULK_SENSE
Text Label 9750 4900 0    60   ~ 0
I2C_SCL
Text Label 9050 4900 2    60   ~ 0
I2C_SDA
Text Label 9050 5200 2    60   ~ 0
MCU_PRECHARGE_FET
Text Label 9050 5100 2    60   ~ 0
MCU_DISCHARGE_FET
Text Label 9750 5200 0    60   ~ 0
MCU_LOAD_SENSE
$Comp
L GND #PWR03
U 1 1 5A83A2F6
P 2600 1400
F 0 "#PWR03" H 2600 1150 50  0001 C CNN
F 1 "GND" H 2600 1250 50  0000 C CNN
F 2 "" H 2600 1400 50  0001 C CNN
F 3 "" H 2600 1400 50  0001 C CNN
	1    2600 1400
	1    0    0    -1  
$EndComp
$Comp
L +3V3 #PWR04
U 1 1 5A83A396
P 2150 1200
F 0 "#PWR04" H 2150 1050 50  0001 C CNN
F 1 "+3V3" H 2150 1340 50  0000 C CNN
F 2 "" H 2150 1200 50  0001 C CNN
F 3 "" H 2150 1200 50  0001 C CNN
	1    2150 1200
	1    0    0    -1  
$EndComp
Text Label 9750 5000 0    60   ~ 0
MCU_SWITCH_ID
Text Label 9050 4500 2    60   ~ 0
BAT+
Text Label 9050 4600 2    60   ~ 0
BAT+
Text Label 9750 4500 0    60   ~ 0
BAT+
Text Label 9750 4600 0    60   ~ 0
BAT+
Text Label 9750 4800 0    60   ~ 0
GND
Text Label 9750 4700 0    60   ~ 0
GND
Text Label 9050 4800 2    60   ~ 0
GND
Text Label 9050 4700 2    60   ~ 0
GND
Text Label 9750 5100 0    60   ~ 0
MCU_SWITCH_TEMP
Text Label 9050 5000 2    60   ~ 0
+3V3
Text GLabel 2050 1300 0    60   Input ~ 0
+3V3
Text GLabel 2700 1300 2    60   Input ~ 0
GND
Text Label 2600 5550 0    60   ~ 0
WATCHDOG
Text Label 6250 5750 0    60   ~ 0
MCU_PRECHARGE_FET
Text Label 6250 5850 0    60   ~ 0
MCU_DISCHARGE_FET
Text Label 6250 5450 0    60   ~ 0
MCU_SWITCH_ID
Text Label 6250 5250 0    60   ~ 0
MCU_CHARGER_SENSE
Text Label 6250 5150 0    60   ~ 0
MCU_BULK_SENSE
Text Label 6250 5650 0    60   ~ 0
MCU_SWITCH_TEMP
Text Label 6250 5550 0    60   ~ 0
MCU_LOAD_SENSE
$Sheet
S 3700 2500 1750 600 
U 5A858D57
F0 "ChargeFET" 60
F1 "ChargeFET.sch" 60
F2 "FROM_CHARGER" I R 5450 2650 60 
F3 "TO_BATTERY" O L 3700 2650 60 
F4 "FET_CONTROL" I R 5450 2850 60 
F5 "WATCHDOG" O R 5450 2950 60 
$EndSheet
Wire Wire Line
	3050 2650 3050 3550
Wire Wire Line
	1000 2650 1600 2650
Wire Wire Line
	1600 5150 1300 5150
Wire Wire Line
	1300 5150 1300 2650
Connection ~ 1300 2650
Connection ~ 3050 2650
Wire Wire Line
	2500 5150 4300 5150
Wire Wire Line
	2500 5250 4300 5250
Wire Wire Line
	2500 5350 4300 5350
Wire Wire Line
	2500 5450 4300 5450
Wire Wire Line
	4300 5050 4200 5050
Wire Wire Line
	4300 4950 4200 4950
Wire Wire Line
	2500 2850 2600 2850
Wire Wire Line
	2500 2950 2600 2950
Wire Wire Line
	9400 2650 10300 2650
Wire Wire Line
	3050 3550 2450 3550
Wire Wire Line
	9650 3000 9650 3100
Wire Wire Line
	9650 3050 9800 3050
Connection ~ 9650 3050
Wire Wire Line
	9650 2700 9650 2650
Connection ~ 9650 2650
Wire Wire Line
	9650 3400 9650 3450
Wire Wire Line
	9150 4500 9050 4500
Wire Wire Line
	9150 4600 9050 4600
Wire Wire Line
	9650 4500 9750 4500
Wire Wire Line
	9650 4600 9750 4600
Wire Wire Line
	9650 4700 9750 4700
Wire Wire Line
	9650 4800 9750 4800
Wire Wire Line
	9650 4900 9750 4900
Wire Wire Line
	9650 5000 9750 5000
Wire Wire Line
	9650 5100 9750 5100
Wire Wire Line
	9650 5200 9750 5200
Wire Wire Line
	9150 5200 9050 5200
Wire Wire Line
	9150 5100 9050 5100
Wire Wire Line
	9150 5000 9050 5000
Wire Wire Line
	9150 4900 9050 4900
Wire Wire Line
	9150 4800 9050 4800
Wire Wire Line
	9150 4700 9050 4700
Wire Wire Line
	6400 3000 6400 3100
Wire Wire Line
	6400 3050 6550 3050
Connection ~ 6400 3050
Wire Wire Line
	6400 3400 6400 3450
Wire Wire Line
	6400 2300 6400 2700
Connection ~ 6400 2650
Wire Wire Line
	10400 2400 10300 2400
Wire Wire Line
	10300 2400 10300 2650
Wire Wire Line
	10400 2300 6400 2300
Wire Wire Line
	7700 2850 7800 2850
Wire Wire Line
	7800 2950 7700 2950
Wire Wire Line
	2500 2650 3700 2650
Wire Wire Line
	5450 2650 7800 2650
Wire Wire Line
	5450 2950 5550 2950
Wire Wire Line
	2150 1200 2150 1300
Wire Wire Line
	2150 1300 2050 1300
Wire Wire Line
	2700 1300 2600 1300
Wire Wire Line
	2600 1300 2600 1400
Wire Wire Line
	6150 5150 6250 5150
Wire Wire Line
	6150 5250 6250 5250
Wire Wire Line
	6150 5450 6250 5450
Wire Wire Line
	6150 5550 6250 5550
Wire Wire Line
	6150 5650 6250 5650
Wire Wire Line
	6150 5750 6250 5750
Wire Wire Line
	6150 5850 6250 5850
Text Label 2150 1300 0    60   ~ 0
+3V3
Text Label 2600 1300 2    60   ~ 0
GND
Wire Wire Line
	2500 5550 2600 5550
Text Label 5550 2950 0    60   ~ 0
WATCHDOG
Wire Wire Line
	5450 2850 5550 2850
Text Label 5550 2850 0    60   ~ 0
CHARGE_FET
Text Label 6250 4950 0    60   ~ 0
CHARGE_FET
Wire Wire Line
	6250 4950 6150 4950
Wire Wire Line
	2450 3650 3400 3650
Text Notes 10150 2200 0    60   ~ 0
Charger connector
Wire Wire Line
	3400 5750 4300 5750
Wire Wire Line
	3400 3650 3400 5750
Wire Wire Line
	2500 5650 3150 5650
Wire Wire Line
	3150 5650 3150 3750
Wire Wire Line
	3150 3750 2450 3750
Text Label 10400 2300 0    60   ~ 0
BULK_CHARGER
Text Label 10400 2400 0    60   ~ 0
BOOST_CHARGER
Wire Wire Line
	7800 3050 7700 3050
Text Label 7600 3200 2    60   ~ 0
BOOST_ENABLE
Wire Wire Line
	7700 3050 7700 3200
Wire Wire Line
	7700 3200 7600 3200
Wire Wire Line
	4300 4850 4200 4850
Text Label 4200 4850 2    60   ~ 0
BOOST_ENABLE
$EndSCHEMATC
